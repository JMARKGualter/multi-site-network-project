Router 1 (HQ)
enable
enable
configure terminal
hostname R1
interface g0/0
no shutdown
interface g0/0.10
encapsulation dot1Q 10
ip address 192.168.10.1 255.255.255.224
no shutdown
interface g0/0.20
encapsulation dot1Q 20
ip address 192.168.20.1 255.255.255.224
no shutdown
interface g0/0.99
encapsulation dot1Q 99
ip address 192.168.99.254 255.255.255.0
no shutdown
interface g1/0
ip address 10.0.12.1 255.255.255.252
ip mtu 1500
no shutdown
interface g2/0
ip address 10.0.13.1 255.255.255.252
ip mtu 1500
no shutdown
interface g3/0
ip address 10.0.23.1 255.255.255.252
ip mtu 1500
no shutdown
interface g4/0
ip address 10.0.24.1 255.255.255.252
ip mtu 1500
no shutdown
router ospf 1
router-id 1.1.1.1
network 192.168.10.0 0.0.0.31 area 0
network 192.168.20.0 0.0.0.31 area 0
network 192.168.99.0 0.0.0.255 area 0
network 10.0.12.0 0.0.0.3 area 0
network 10.0.13.0 0.0.0.3 area 0
network 10.0.23.0 0.0.0.3 area 0
network 10.0.24.0 0.0.0.3 area 0
end
write
-----------------------------------------------------

Branch 1 Router 2

enable
configure terminal
hostname R2
interface g0/0
no shutdown
interface g0/0.30
encapsulation dot1Q 30
ip address 192.168.30.1 255.255.255.224
no shutdown
interface g0/0.40
encapsulation dot1Q 40
ip address 192.168.40.1 255.255.255.224
no shutdown
interface g0/0.99
encapsulation dot1Q 99
ip address 192.168.99.254 255.255.255.0
no shutdown
interface g1/0
ip address 10.0.12.2 255.255.255.252
ip mtu 1500
no shutdown
interface g2/0
ip address 10.0.13.2 255.255.255.252
ip mtu 1500
no shutdown
interface g3/0
ip address 10.0.34.1 255.255.255.252
ip mtu 1500
no shutdown
interface g4/0
ip address 10.0.35.1 255.255.255.252
ip mtu 1500
no shutdown
router ospf 1
router-id 2.2.2.2
network 192.168.30.0 0.0.0.31 area 0
network 192.168.40.0 0.0.0.31 area 0
network 192.168.99.0 0.0.0.255 area 0
network 10.0.12.0 0.0.0.3 area 0
network 10.0.13.0 0.0.0.3 area 0
network 10.0.34.0 0.0.0.3 area 0
network 10.0.35.0 0.0.0.3 area 0
ip access-list extended BLOCK_BRANCH2
deny ip 192.168.30.0 0.0.0.31 192.168.50.0 0.0.0.31
deny ip 192.168.30.0 0.0.0.31 192.168.60.0 0.0.0.31
deny ip 192.168.40.0 0.0.0.31 192.168.50.0 0.0.0.31
deny ip 192.168.40.0 0.0.0.31 192.168.60.0 0.0.0.31
permit ip any any
exit
interface g3/0
ip access-group BLOCK_BRANCH2 out
exit
interface g4/0
ip access-group BLOCK_BRANCH2 out
exit
end
write

--------------------------------------------------------------

Branch 2 Router 3
enable
configure terminal
hostname R3
interface g0/0
no shutdown
interface g0/0.50
encapsulation dot1Q 50
ip address 192.168.50.1 255.255.255.224
no shutdown
interface g0/0.60
encapsulation dot1Q 60
ip address 192.168.60.1 255.255.255.224
no shutdown
interface g0/0.99
encapsulation dot1Q 99
ip address 192.168.99.254 255.255.255.0
no shutdown
interface g1/0
ip address 10.0.23.2 255.255.255.252
ip mtu 1500
no shutdown
interface g2/0
ip address 10.0.24.2 255.255.255.252
ip mtu 1500
no shutdown
interface g3/0
ip address 10.0.34.2 255.255.255.252
ip mtu 1500
no shutdown
interface g4/0
ip address 10.0.35.2 255.255.255.252
ip mtu 1500
no shutdown
router ospf 1
router-id 3.3.3.3
network 192.168.50.0 0.0.0.31 area 0
network 192.168.60.0 0.0.0.31 area 0
network 192.168.99.0 0.0.0.255 area 0
network 10.0.23.0 0.0.0.3 area 0
network 10.0.24.0 0.0.0.3 area 0
network 10.0.34.0 0.0.0.3 area 0
network 10.0.35.0 0.0.0.3 area 0
ip access-list extended BLOCK_BRANCH1
deny ip 192.168.50.0 0.0.0.31 192.168.30.0 0.0.0.31
deny ip 192.168.50.0 0.0.0.31 192.168.40.0 0.0.0.31
deny ip 192.168.60.0 0.0.0.31 192.168.30.0 0.0.0.31
deny ip 192.168.60.0 0.0.0.31 192.168.40.0 0.0.0.31
permit ip any any
exit
interface g3/0
ip access-group BLOCK_BRANCH1 out
exit
interface g4/0
ip access-group BLOCK_BRANCH1 out
exit
end
write

---------------------------------------------------------------------------------

HQ Switch 1

enable
configure terminal
hostname SW1
vlan 10
name HQ_VLAN10
vlan 20
name HQ_VLAN20
vlan 99
name Management
exit
interface range fastethernet0/1, fastethernet0/3, fastethernet0/5, fastethernet0/7, fastethernet0/9, fastethernet0/11, fastethernet0/13, fastethernet0/15, fastethernet0/17, fastethernet0/19
switchport mode access
switchport access vlan 10
no shutdown
exit
interface range fastethernet0/2, fastethernet0/4, fastethernet0/6, fastethernet0/8, fastethernet0/10, fastethernet0/12, fastethernet0/14, fastethernet0/16, fastethernet0/18, fastethernet0/20
switchport mode access
switchport access vlan 20
no shutdown
exit
interface gigabit0/1
switchport mode trunk
switchport trunk allowed vlan 10,20,99
no shutdown
exit
interface vlan 99
ip address 192.168.99.1 255.255.255.0
no shutdown
exit
ip default-gateway 192.168.99.254
end
write

-------------------------------------------------------------------------------------
Branch 1 SW2

enable
configure terminal
hostname SW2
vlan 30
name BRANCH1_VLAN30
vlan 40
name BRANCH1_VLAN40
vlan 99
name Management
exit
interface range fastethernet0/1, fastethernet0/3, fastethernet0/5, fastethernet0/7, fastethernet0/9, fastethernet0/11, fastethernet0/13, fastethernet0/15, fastethernet0/17, fastethernet0/19
switchport mode access
switchport access vlan 30
no shutdown
exit
interface range fastethernet0/2, fastethernet0/4, fastethernet0/6, fastethernet0/8, fastethernet0/10, fastethernet0/12, fastethernet0/14, fastethernet0/16, fastethernet0/18, fastethernet0/20
switchport mode access
switchport access vlan 40
no shutdown
exit
interface gigabit0/1
switchport mode trunk
switchport trunk allowed vlan 30,40,99
no shutdown
exit
interface vlan 99
ip address 192.168.99.2 255.255.255.0
no shutdown
exit
ip default-gateway 192.168.99.254
end
write

---------------------------------------------------------------------------------------
Branch 2 SW3

enable
configure terminal
hostname SW3
vlan 50
name BRANCH2_VLAN50
vlan 60
name BRANCH2_VLAN60
vlan 99
name Management
exit
interface range fastethernet0/1, fastethernet0/3, fastethernet0/5, fastethernet0/7, fastethernet0/9, fastethernet0/11, fastethernet0/13, fastethernet0/15, fastethernet0/17, fastethernet0/19
switchport mode access
switchport access vlan 50
no shutdown
exit
interface range fastethernet0/2, fastethernet0/4, fastethernet0/6, fastethernet0/8, fastethernet0/10, fastethernet0/12, fastethernet0/14, fastethernet0/16, fastethernet0/18, fastethernet0/20
switchport mode access
switchport access vlan 60
no shutdown
exit
interface gigabit0/1
switchport mode trunk
switchport trunk allowed vlan 50,60,99
no shutdown
exit
interface vlan 99
ip address 192.168.99.3 255.255.255.0
no shutdown
exit
ip default-gateway 192.168.99.254
end
write
--------------------------------------------------------------------------------------

